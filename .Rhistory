facet_wrap("season") + geom_point()
ggplot(seasonal_day_delay, aes(x=dayofweek,y=Average_Departure_Delay, colour=dayofweek))+
facet_wrap("season") + geom_point() +  geom_line()
ggplot(seasonal_day_delay, aes(x=dayofweek,y=Average_Departure_Delay, colour=dayofweek))+
facet_wrap("season") + geom_line() + geom_point()
ggplot(seasonal_day_delay, aes(x=dayofweek,y=Average_Departure_Delay, colour=dayofweek, group = dayofweek))+
facet_wrap("season") + geom_line() + geom_point()
ggplot(seasonal_day_delay, aes(x=dayofweek,y=Average_Departure_Delay, colour=dayofweek, group = season))+
facet_wrap("season") + geom_line() + geom_point()
season_time_delay <- db %>%  filter(departure_delay>=15) %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
group_by(season, departure_time) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay1 <- season_time_delay %>% collect()
season_time_delay1$departure_time<-as.POSIXct(season_time_delay1$departure_time)
season_time_delay1 %>%
ggplot(aes(x = departure_time, y = Average_Departure_Delay)) +
geom_line() +
facet_wrap("season") +
ylab("Average Departure Delay") +
xlab("Time of Day") +
scale_y_continuous(labels = scales::percent) +
scale_x_datetime(date_breaks = "4 hours",
date_labels = "%H")
season_delay <- db %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
group_by(season) %>%
summarize(Percentage_Delay = sum(departure_delay=> 15) / sum(departure_delay))
season_delay <- db %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
group_by(season) %>%
summarize(Percentage_Delay = sum(departure_delay >=15) / sum(departure_delay))
seasonal_delay <- season_delay %>% collect()
season_delay <- db %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
group_by(season) %>%
summarize(Percentage_Delay = count(departure_delay >=15) / count(departure_delay))
seasonal_delay <- season_delay %>% collect()
p<-ggplot(data=seasonal_delay, aes(x=season, y=Percentage_Delay, fill = season )) +
geom_bar(stat="identity")
p
p<-ggplot(data=seasonal_delay, aes(x=season, y=Percentage_Delay, fill = season )) +
geom_point()
p
p<-ggplot(data=seasonal_delay, aes(x=season, y=Percentage_Delay, fill = season )) +
geom_bar()
p
seasonal_delay
season_delay <- db %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
group_by(season) %>%
summarize(Percentage_Delay = count(departure_delay) >=15 / count(departure_delay))
season_delay <- db %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
group_by(season) %>%
summarize(Percentage_Delay = count(departure_delay) >=15 / count(departure_delay))
seasonal_delay <- season_delay %>% collect()
seasonal_delay
season_delay <- db %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
mutate(is_delayed = arr_delay >= 15) %>%
group_by(season) %>%
summarize(Percentage_Delay = count(is_delayed) >=15 / count(departure_delay))
seasonal_delay <- season_delay %>% collect()
season_delay <- db %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
mutate(is_delayed = departure_delay >= 15) %>%
group_by(season) %>%
summarize(Percentage_Delay = count(is_delayed) >=15 / count(departure_delay))
seasonal_delay <- season_delay %>% collect()
seasonal_delay
season_delay <- db %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
mutate(is_delayed = departure_delay >= 15) %>%
group_by(season) %>%
summarize(Percentage_Delay = count(is_delayed) / count(departure_delay))
seasonal_delay <- season_delay %>% collect()
seasonal_delay
season_delay
season_delay <- db %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
mutate(is_delayed = departure_delay >= 15) %>%
group_by(season) %>%
summarize(Percentage_Delay = count(is_delayed==TRUE) / count(departure_delay))
seasonal_delay <- season_delay %>% collect()
seasonal_delay
season_delay <- db %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
mutate(is_delayed = departure_delay >= 15) %>%
group_by(season) %>%
summarize(Percentage_Delay = count(db$is_delayed==TRUE) / count(departure_delay))
seasonal_delay <- season_delay %>% collect()
season_delay %>% show_query()
season_delay <- db %>% filter(departure_delay>=15)  %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
group_by(season) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_delay %>% show_query()
season_day_delay <- db %>% filter(departure_delay>=15) %>% mutate(
season = case_when(
month(scheduled_departure) %in% 10:12 ~ "Fall",
month(scheduled_departure) %in%  1:3  ~ "Winter",
month(scheduled_departure) %in%  4:6  ~ "Spring",
TRUE ~ "Summer")) %>%
group_by(season, wday(scheduled_departure)) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_day_delay %>% show_query()
seasonal_day_delay <- season_day_delay %>% collect()
seasonal_day_delay
month_delay <- db %>% filter(departure_delay>=15) %>%
group_by(month(scheduled_departure)) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
month_delay %>% show_query()
month_delay <- month_delay %>% collect()
month_delay
p<-ggplot(data=month_delay, aes(x=reorder(month, month.name), y=Average_Departure_Delay, fill=month.name )) +
geom_bar(stat="identity")
p
month_delay
p<-ggplot(data=month_delay, aes(x=reorder(month(scheduled_departure)
, month.name), y=Average_Departure_Delay, fill=month.name )) +
geom_bar(stat="identity")
p
p<-ggplot(data=month_delay, aes(x=reorder(month, month.name), y=Average_Departure_Delay, fill=month.name )) +
geom_bar(stat="identity")
p
month_delay <- db %>% filter(departure_delay>=15) %>%
month = month(scheduled_departure)
month_delay <- db %>% filter(departure_delay>=15) %>%
month = month(scheduled_departure)
month_delay <- db %>% filter(departure_delay>=15) %>% mutate (
month1 = month(scheduled_departure)
)%>%
group_by(month1) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
month_delay %>% show_query()
month_delay <- month_delay %>% collect()
month_delay <- month_delay %>% collect()
month_delay
p<-ggplot(data=month_delay, aes(x=reorder(month1, month1.name), y=Average_Departure_Delay, fill=month.name )) +
geom_bar(stat="identity")
p
p<-ggplot(data=month_delay, aes(x=reorder(month1, month.name), y=Average_Departure_Delay, fill=month.name )) +
geom_bar(stat="identity")
p
library(DBI)
library(RODBC)
library(odbc)
library(dbplyr)
pacman::p_load(pacman, dplyr, GGally, ggplot2, ggthemes,
ggvis, httr, lubridate, plotly, rio, rmarkdown, shiny,
stringr, tidyr, psych)
con <- DBI::dbConnect(odbc::odbc(), "PostgreSQL30") #establishing a connection to the PostgreSQL Database
library(DBI)
library(RODBC)
library(odbc)
library(dbplyr)
pacman::p_load(pacman, dplyr, GGally, ggplot2, ggthemes,
ggvis, httr, lubridate, plotly, rio, rmarkdown, shiny,
stringr, tidyr, psych)
con <- DBI::dbConnect(odbc::odbc(), "PostgreSQL30") #establishing a connection to the PostgreSQL Database
```{r}
```{r}
db <- tbl(con, "df") #taking a reference to the remote database
db %>% show_query()
db
season_delay <- db %>% filter(departure_delay>=15)%>%
group_by(season) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_delay %>% show_query()
seasonal_delay <- season_delay %>% collect()
p<-ggplot(data=seasonal_delay, aes(x=season, y=Average_Departure_Delay, fill = season )) +
geom_bar(stat="identity")
p
seasonal_delay
month_delay <- db %>% filter(departure_delay>=15) %>% mutate (
month = month(scheduled_departure)
)%>%
group_by(month) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
month_delay %>% show_query()
month_delay <- month_delay %>% collect()
month_delay
p<-ggplot(data=month_delay, aes(x=reorder(month, month.name), y=Average_Departure_Delay, fill=month.name )) +
geom_bar(stat="identity")
p
month_delay
p<-ggplot(data=month_delay, aes(x=reorder(month, month.name), y=Average_Departure_Delay, fill=month.name )) +
geom_bar(stat="identity")
p
season_day_delay <- db %>% filter(departure_delay>=15) %>%
group_by(season, wday(scheduled_departure)) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_day_delay %>% show_query()
seasonal_day_delay <- season_day_delay %>% collect()
seasonal_day_delay
p<-ggplot(data=seasonal_delay, aes(x=season, y=Average_Departure_Delay, fill = season )) +
geom_bar(stat="identity")
p
seasonal_day_delay <- season_day_delay %>% collect()
seasonal_day_delay
ggplot(seasonal_day_delay, aes(x=dayofweek,y=Average_Departure_Delay, colour=dayofweek, group = season))+
facet_wrap("season") + geom_line() + geom_point()
season_day_delay <- db %>% filter(departure_delay>=15) %>% mutate (
dayofweek = wday(scheduled_departure))
season_day_delay %>% show_query()
seasonal_day_delay <- season_day_delay %>% collect()
season_day_delay <- db %>% filter(departure_delay>=15) %>% mutate (
dayofweek = wday(scheduled_departure))  %>%
group_by(season, dayofweek) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_day_delay %>% show_query()
seasonal_day_delay <- season_day_delay %>% collect()
seasonal_day_delay
ggplot(seasonal_day_delay, aes(x=dayofweek,y=Average_Departure_Delay, colour=dayofweek, group = season))+
facet_wrap("season") + geom_line() + geom_point()
ggplot(seasonal_day_delay, aes(x=dayofweek,y=Average_Departure_Delay, colour=dayofweek, group = dayofweek))+
facet_wrap("season") + geom_line() + geom_point()
ggplot(seasonal_day_delay, aes(x=dayofweek,y=Average_Departure_Delay, colour=dayofweek, group = season))+
facet_wrap("season") + geom_line() + geom_point()
seasonal_day_delay
season_day_delay <- db %>% filter(departure_delay>=15) %>% mutate (
dayofweek = wday(scheduled_departure, label = TRUE))  %>%
group_by(season, dayofweek) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_day_delay %>% show_query()
seasonal_day_delay <- season_day_delay %>% collect()
season_day_delay <- db %>% filter(departure_delay>=15) %>% mutate (
dayofweek = wday(scheduled_departure))  %>%
group_by(season, dayofweek) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_day_delay %>% show_query()
seasonal_day_delay <- season_day_delay %>% collect()
seasonal_day_delay
ggplot(seasonal_day_delay, aes(x=dayofweek.,y=Average_Departure_Delay, colour=dayofweek, group = season))+
facet_wrap("season") + geom_line() + geom_point()
ggplot(seasonal_day_delay, aes(x=dayofweek,y=Average_Departure_Delay, colour=dayofweek, group = season))+
facet_wrap("season") + geom_line() + geom_point()
season_time_delay <- db %>%  filter(departure_delay>=15) %>%
mutate(departure_time1 <-as.POSIXct(season_time_delay1$departure_time))  %>%
group_by(season, departure_time1) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay <- db %>%  filter(departure_delay>=15) %>%
mutate(departure_time1 <-as.POSIXct(departure_time))  %>%
group_by(season, departure_time1) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay <- db %>%  filter(departure_delay>=15) %>%
group_by(season, departure_time) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay1 <- season_time_delay %>% collect()
season_time_delay1$departure_time<-as.POSIXct(season_time_delay1$departure_time)
season_time_delay1
season_time_delay1 %>%
ggplot(aes(x = departure_time, y = Average_Departure_Delay)) +
geom_line() +
facet_wrap("season") +
ylab("Average Departure Delay") +
xlab("Time of Day") +
scale_y_continuous(labels = scales::percent) +
scale_x_datetime(date_breaks = "4 hours",
date_labels = "%H")
season_time_delay1
season_time_delay <- db %>%  filter(departure_delay>=15) %>%
group_by(season, departure_time) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay1 <- season_time_delay %>% collect()
season_time_delay1$departure_time<-as.POSIXct(as.numeric(as.POSIXct(season_time_delay1$departure_time)) %% 86400, origin = "2000-01-01")
season_time_delay1
season_time_delay1 %>%
ggplot(aes(x = departure_time, y = Average_Departure_Delay)) +
geom_line() +
facet_wrap("season") +
ylab("Average Departure Delay") +
xlab("Time of Day") +
scale_y_continuous(labels = scales::percent) +
scale_x_datetime(date_breaks = "4 hours",
date_labels = "%H")
season_time_delay1 %>%
ggplot(aes(x = departure_time, y = Average_Departure_Delay)) +
geom_line() +
facet_wrap("season") +
ylab("Average Departure Delay") +
xlab("Time of Day") +
scale_y_continuous() +
scale_x_datetime(date_breaks = "4 hours",
date_labels = "%H")
season_time_delay1 %>%
ggplot(aes(x = departure_time, y = Average_Departure_Delay)) +
geom_line() +
facet_wrap("season") +
ylab("Average Departure Delay") +
xlab("Time of Day") +
scale_y_continuous() +
scale_x_datetime(date_breaks = "1 hours",
date_labels = "%H")
season_time_delay1 %>%
ggplot(aes(x = departure_time, y = Average_Departure_Delay)) +
geom_line() +
facet_wrap("season") +
ylab("Average Departure Delay") +
xlab("Time of Day") +
scale_y_continuous() +
scale_x_datetime(date_breaks = "4 hours",
date_labels = "%H")
season_time_delay1 %>%
ggplot(aes(x = departure_time, y = Average_Departure_Delay, color = season)) +
geom_line() +
facet_wrap("season") +
ylab("Average Departure Delay") +
xlab("Time of Day") +
scale_y_continuous() +
scale_x_datetime(date_breaks = "4 hours",
date_labels = "%H")
library(DBI)
library(RODBC)
library(odbc)
library(dbplyr)
pacman::p_load(pacman, dplyr, GGally, ggplot2, ggthemes,
ggvis, httr, lubridate, plotly, rio, rmarkdown, shiny,
stringr, tidyr, psych)
con <- DBI::dbConnect(odbc::odbc(), "PostgreSQL30")
db <- tbl(con, "df") #taking a reference to the remote database
db %>% show_query()
db
season_delay <- db %>% filter(departure_delay>=15)%>%
group_by(season) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
seasonal_delay <- season_delay %>% collect()
seasonal_delay
p<-ggplot(data=seasonal_delay, aes(x=season, y=Average_Departure_Delay, fill = season )) +
geom_bar(stat="identity")
p
month_delay <- db %>% filter(departure_delay>=15) %>% mutate (
month = month(scheduled_departure)
)%>%
group_by(month) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
month_delay <- month_delay %>% collect()
month_delay
p<-ggplot(data=month_delay, aes(x=reorder(month, month.name), y=Average_Departure_Delay, fill=month.name )) +
geom_bar(stat="identity")
p
season_day_delay <- db %>% filter(departure_delay>=15) %>% mutate (
dayofweek = wday(scheduled_departure))  %>%
group_by(season, dayofweek) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_day_delay %>% show_query()
seasonal_day_delay <- season_day_delay %>% collect()
seasonal_day_delay
ggplot(seasonal_day_delay, aes(x=dayofweek,y=Average_Departure_Delay, colour=dayofweek, group = season))+
facet_wrap("season") + geom_line() + geom_point()
season_time_delay <- db %>%  filter(departure_delay>=15) %>%
group_by(season, departure_time) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay1 <- season_time_delay %>% collect()
season_time_delay1$departure_time<-as.POSIXct(as.numeric(as.POSIXct(season_time_delay1$departure_time)) %% 86400, origin = "2000-01-01")
season_time_delay1
season_time_delay1 %>%
ggplot(aes(x = departure_time, y = Average_Departure_Delay, color = season)) +
geom_line() +
facet_wrap("season") +
ylab("Average Departure Delay") +
xlab("Time of Day") +
scale_y_continuous() +
scale_x_datetime(date_breaks = "4 hours",
date_labels = "%H")
season_time_delay <- db %>%  filter(departure_delay>=15) %>% mutate (dep_time = case_when(
strftime(scheduled_departure, format="%H") %in% '16':'20' ~ "4pm - 8pm",
strftime(scheduled_departure, format="%H") %in%  '1':'4'  ~ "1am - 4am",
strftime(scheduled_departure, format="%H") %in%  '5':'8'  ~ "5am - 8am",
strftime(scheduled_departure, format="%H") %in%  '9':'12'  ~ "9am - 12pm",
strftime(scheduled_departure, format="%H") %in%  '12':'15'  ~ "12pm - 3pm",
TRUE ~ "9pm - 12am")) %>%
group_by(season, dep_time) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay1 <- season_time_delay %>% collect()
season_time_delay <- db %>%  filter(departure_delay>=15) %>% mutate (dep_time = case_when(
as.numeric(strftime(scheduled_departure, format="%H")) %in% 16:20 ~ "4pm - 8pm",
as.numeric(strftime(scheduled_departure, format="%H")) %in%  1:4  ~ "1am - 4am",
as.numeric(strftime(scheduled_departure, format="%H")) %in%  5:8  ~ "5am - 8am",
as.numeric(strftime(scheduled_departure, format="%H")) %in%  9:12  ~ "9am - 12pm",
as.numeric(strftime(scheduled_departure, format="%H")) %in%  12:15  ~ "12pm - 3pm",
TRUE ~ "9pm - 12am")) %>%
group_by(season, dep_time) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay1 <- season_time_delay %>% collect()
season_time_delay <- db %>%  filter(departure_delay>=15) %>% mutate (dep_time = case_when(
as.integer(strftime(scheduled_departure, format="%H")) %in% 16:20 ~ "4pm - 8pm",
as.integer(strftime(scheduled_departure, format="%H")) %in%  1:4  ~ "1am - 4am",
as.integer(strftime(scheduled_departure, format="%H")) %in%  5:8  ~ "5am - 8am",
as.integer(strftime(scheduled_departure, format="%H")) %in%  9:12  ~ "9am - 12pm",
as.integer(strftime(scheduled_departure, format="%H")) %in%  12:15  ~ "12pm - 3pm",
TRUE ~ "9pm - 12am")) %>%
group_by(season, dep_time) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay1
season_time_delay <- db %>%  filter(departure_delay>=15) %>% mutate (dep_time = case_when(
as.integer(strftime(scheduled_departure, format="%H")) %in% 16:20 ~ "4pm - 8pm",
as.integer(strftime(scheduled_departure, format="%H")) %in%  1:4  ~ "1am - 4am",
as.integer(strftime(scheduled_departure, format="%H")) %in%  5:8  ~ "5am - 8am",
as.integer(strftime(scheduled_departure, format="%H")) %in%  9:12  ~ "9am - 12pm",
as.integer(strftime(scheduled_departure, format="%H")) %in%  12:15  ~ "12pm - 3pm",
TRUE ~ "9pm - 12am")) %>%
group_by(season, dep_time) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay1 <- season_time_delay %>% collect()
season_time_delay <- db %>%  filter(departure_delay>=15) %>% mutate (dep_time = format(scheduled_departure,"%H")) %>%
group_by(season, dep_time) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay1 <- season_time_delay %>% collect()
season_time_delay <- db %>%  filter(departure_delay>=15) %>% mutate (dep_time = case_when(
hour(scheduled_departure) %in% 16:20 ~ "4pm - 8pm",
hour(scheduled_departure) %in%  1:4  ~ "1am - 4am",
hour(scheduled_departure) %in%  5:8  ~ "5am - 8am",
hour(scheduled_departure) %in%  9:12  ~ "9am - 12pm",
hour(scheduled_departure) %in%  12:15  ~ "12pm - 3pm",
TRUE ~ "9pm - 12am")) %>%
group_by(season, dep_time) %>%
summarize(Average_Departure_Delay = mean(departure_delay))
season_time_delay1 <- season_time_delay %>% collect()
season_time_delay1
season_time_delay1 %>%
ggplot(aes(x = dep_time, y = Average_Departure_Delay, color = season)) +
geom_line() +
facet_wrap("season") +
ylab("Average Departure Delay") +
xlab("Time of Day") +
scale_y_continuous() +
scale_x_datetime(date_breaks = "4 hours",
date_labels = "%H")
season_time_delay1$departure_time<-as.POSIXct(as.numeric(as.POSIXct(season_time_delay1$departure_time)) %% 86400, origin = "2000-01-01")
ggplot(season_time_delay1, aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time +
ggplot(season_time_delay1, aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time))+
geom_bar(stat="identity", width=.5, position = "dodge", )+
labs(title="Average Turn Delay across Time of Day",y = 'Average Turn Delay Duration',x = 'Time of Day', fill='Year')
p < -ggplot(season_time_delay1, aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time)) +
season_time_delay1 %>% ggplot(aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time)) +
geom_bar(stat="identity", width=.5, position = "dodge", ) +
labs(title="Average Turn Delay across Time of Day",y = 'Average Turn Delay Duration',x = 'Time of Day', fill='Year')
season_time_delay1 %>% ggplot(aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time)) +facet_wrap("season")+
geom_bar(stat="identity", width=.5, position = "dodge", ) +
labs(title="Average Turn Delay across Time of Day",y = 'Average Turn Delay Duration',x = 'Time of Day', fill='Year')
season_time_delay1 %>% ggplot(aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time)) +facet_wrap("season")+
geom_bar(stat="identity", width=.5, position = "dodge", ) +
labs(title="Average Turn Delay across Time of Day",y = 'Average Turn Delay Duration',x = 'Time of Day', fill='') + guide = guide_axis(n.dodge=3)
season_time_delay1 %>% ggplot(aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time)) +facet_wrap("season")+
geom_bar(stat="identity", width=.5, position = "dodge", ) +
labs(title="Average Turn Delay across Time of Day",y = 'Average Turn Delay Duration',x = 'Time of Day', fill='') + guide = guide_axis(n.dodge=3))
season_time_delay1 %>% ggplot(aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time)) +facet_wrap("season")+
geom_bar(stat="identity", width=.5, position = "dodge", ) +
labs(title="Average Turn Delay across Time of Day",y = 'Average Turn Delay Duration',x = 'Time of Day', fill='') + scale_x_discrete(guide = guide_axis(n.dodge=3))
season_time_delay1 %>% ggplot(aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time)) +facet_wrap("season")+
geom_bar(stat="identity", width=.5, position = "dodge", ) +
labs(title="Average Turn Delay across Time of Day",y = 'Average Turn Delay Duration',x = 'Time of Day', fill='') + scale_x_discrete(guide = guide_axis(n.dodge=2))
season_time_delay1 %>% ggplot(aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time)) +facet_wrap("season")+
geom_bar(stat="identity", width=.5, position = "dodge", ) +
labs(title="Average Turn Delay across Time of Day",y = 'Average Turn Delay Duration',x = 'Time of Day', fill='') + scale_x_discrete(guide = guide_axis(n.dodge=5))
season_time_delay1 %>% ggplot(aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time)) +facet_wrap("season")+
geom_bar(stat="identity", width=.5, position = "dodge", ) +
labs(title="Average Turn Delay across Time of Day",y = 'Average Turn Delay Duration',x = 'Time of Day', fill='') + scale_x_discrete(guide = guide_axis(n.dodge=2.5))
par(mar = c(6.5, 6.5, 0.5, 0.5), mgp = c(5, 1, 0))
season_time_delay1 %>% ggplot(aes(x = dep_time, y=Average_Departure_Delay , fill = dep_time)) +facet_wrap("season")+
geom_bar(stat="identity", width=.5, position = "dodge", ) +
labs(title="Average Turn Delay across Time of Day",y = 'Average Turn Delay Duration',x = 'Time of Day', fill='') + scale_x_discrete(guide = guide_axis(n.dodge=2.5))
